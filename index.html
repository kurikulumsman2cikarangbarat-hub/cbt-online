<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Daftar Token Ujian</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f7f6; }
        .card { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        th { background: #007bff; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        .status { text-align: center; font-size: 14px; margin-top: 10px; }
        .error { color: red; font-weight: bold; }
        .btn-refresh { display: block; width: 100%; padding: 10px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

<div class="card">
    <h2>Daftar Token Aktif</h2>
    <button class="btn-refresh" onclick="loadTokens()">Segarkan Data (Fetch)</button>
    <div id="status-area" class="status">Menunggu perintah...</div>
    
    <table id="token-table" style="display: none;">
        <thead>
            <tr>
                <th>No.</th>
                <th>Token</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="token-list">
            </tbody>
    </table>
</div>

<script>
    // GANTI DENGAN URL WORKER ANDA
    const WORKER_URL = "https://URL-WORKER-ANDA.workers.dev";

    async function loadTokens() {
        const statusArea = document.getElementById('status-area');
        const table = document.getElementById('token-table');
        const list = document.getElementById('token-list');

        statusArea.innerHTML = "Sedang mengambil data dari Worker...";
        statusArea.className = "status";
        list.innerHTML = "";
        table.style.display = "none";

        try {
            // Memanggil endpoint /api/ujian yang sudah kita buat di Worker
            const response = await fetch(`${WORKER_URL}/api/ujian`);
            
            if (!response.ok) {
                throw new Error(`HTTP Error! Status: ${response.status}`);
            }

            const data = await response.json();

            if (data.list && data.list.length > 0) {
                data.list.forEach((item, index) => {
                    const row = `<tr>
                        <td>${index + 1}</td>
                        <td><strong>${item.token || 'KOSONG'}</strong></td>
                        <td>âœ… Aktif</td>
                    </tr>`;
                    list.innerHTML += row;
                });
                table.style.display = "table";
                statusArea.innerHTML = `Berhasil memuat ${data.list.length} token.`;
            } else {
                statusArea.innerHTML = "Koneksi berhasil, tapi <b>TIDAK ADA DATA</b> di tabel 'ujian'.";
            }
        } catch (error) {
            console.error("Detail Error:", error);
            statusArea.innerHTML = `<span class="error">Gagal: ${error.message}</span><br><small>Cek Console F12 untuk detail.</small>`;
        }
    }
</script>

</body>
</html>
